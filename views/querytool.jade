extends layout

block content
    div(class="container login marginbottom")
        div
            h1= 'Query.'
            p!="Start querying the database."
            - searchText = "Looking for reagent..."
            - searchTextCatalog = "Looking for catalog number..."
            - classButton = "btn-success"
            - classButtonCatalog = "btn-success"
            if searchformText
                - searchText = "" + searchformText
                - classButton = "btn-success-results"
            if searchformTextCatalog
                - searchTextCatalog = "Search: " + searchformTextCatalog
                - searchformTextCatalog = "Search: " + searchformTextCatalog
                - classButtonCatalog = "btn-success-results"            
            div(id="ctl00_Div2" class="row")
                div
                    if message
                        div(class="alert alert-danger")!= message
                    form(action="/querytool" method="post")
                        textarea(name="queryText" list="agent-datalist" class="form-control" id="queryText" placeholder="Select * from ..." cols="30" rows="5" style="outline: none;overflow:auto;width: 100%;")
                        div(class="buttons")
                            //input(type="submit" class="button" value="Get in")
                            button(class="btn " + classButton + " btn-lg btn-block" type='submit') Submit
                            img(src="images/yoke5.png", alt="The Search", title="Search", style="border-width:0px; width: 50px; margin-top: -77px; margin-left: 300px;")
        
        if(searchResults != null && searchResults.length > 0)
            div(style="background-color: #3d9dcb; height: 2px; margin-bottom: 40px; margin-top: 30px;")
            div
              div
                  span(style="text-align: center")
                    h3="Your query: "
                        if searchformText
                            span(style="color: #3d9dcb;")=" " + searchText
                            span(style="color: #8a6d3b;")=" (" + searchResults.length + ")"
              - style = ""
              - if(error != "error")
                  - style = "overflow: auto; max-height: 300px; border-style: solid;"
              #labyokers.container.results(style="width:100%;word-wrap:break-word;"+style)
                div(id="ctl00_Div2" class="row rank").match
                   - i = 
                   - var j = 1
                   - className = ""
                   div(class="table-responsive" style="margin-top: 20px;")
                     - if(error != "error")  
                       - for(var prop in searchResults)
                            p!="<span class='labColor'><b>" + j + ". </b></span>" + JSON.stringify(searchResults[prop])
                            - j = j + 1
                     - if (error == "error")
                         p(style="text-align:center")="Your query cannot be processed - "
                            span!=JSON.stringify(searchResults).replace(/&quot;/g, '"') 

                    div(id="results")
            div(id="ctl00_Div2" class="row rank")
                - var keys
                div(class="table-responsive")                
                    table(id="rankTblload" class="table rankTbl")
                        thead
                            tr(class="you info-best" style="font-weight: bold")
                                - var keys = Object.keys(searchResults)
                                - for(var prop in keys)
                                    td(class="wrapped")!=JSON.stringify(keys)
                        tbody
                          - var values = Object.keys(searchResults).map(function(key) {return searchResults[key];})
                          -for(var prop in searchResults)
                            tr(class="wrapped")
             
            script="$(window).scrollTop($('#labyokers').offset().top).scrollLeft($('#labyokers').offset().left);"

        

